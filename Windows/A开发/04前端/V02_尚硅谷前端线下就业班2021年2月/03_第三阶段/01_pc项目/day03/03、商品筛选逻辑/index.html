<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="css/index.css">
</head>
<body style="height: 2000px">
<!--模拟body-->
<div class="wrap">
    <!--头部-->
    <div class="header">
        <div class="top">
            <div class="topMain">
                <!--登录注册-->
                <div class="login">
                    <p>欢迎来到尚品汇！ 请</p>
                    <p class="loginBtn">
                        <a href="###" class="btn1">登录</a>
                        <a href="###">注册</a>
                    </p>
                </div>
                <!--头部导航-->
                <div class="topNav">
                    <a href="###">我的订单</a>
                    <a href="###">我的购物车</a>
                    <a href="###">我的尚品汇</a>
                    <a href="###">尚品汇会员</a>
                    <a href="###">企业采购</a>
                    <a href="###">关注尚品汇</a>
                    <a href="###">合作招商</a>
                    <a href="###">商家后台</a>
                </div>
            </div>

        </div>
        <div class="bottom">
            <div class="bottomMain">
                <!--logo-->
                <h1 class="logo">
                    <a href="###">
                        <img src="images/Logo.png" alt="">
                    </a>
                </h1>
                <!--搜索框-->
                <div class="search">
                    <input type="text">
                    <button>搜索</button>
                </div>
            </div>

        </div>
    </div>
    <!--分类导航-->
    <div class="typeNav">
        <div class="typeNavMain">
            <h3>全部商品分类</h3>
            <div>
                <a href="###">服装城</a>
                <a href="###">美妆馆</a>
                <a href="###">尚品汇超市</a>
                <a href="###">全球购</a>
                <a href="###">闪购</a>
                <a href="###">团购</a>
                <a href="###">有趣</a>
                <a href="###">秒杀</a>
            </div>
        </div>
    </div>
    <!--商品内容区域-->
    <div class="main">
        <div class="mainCon">
            <!--路径导航-->
            <div class="conPoin">
                <!--<a href="###">手机、数码、通讯</a>-->
                <!--<i>/</i>-->
                <!--<a href="###">手机</a>-->
                <!--<i>/</i>-->
                <!--<a href="###">Apple苹果</a>-->
                <!--<i>/</i>-->
                <!--<a>iphone 6S系类</a>-->
            </div>
            <!--商品区域-->
            <div class="infoWrap">
                <!--放大镜区域-->
                <div class="previwWrap">
                    <!--放大镜-->
                    <div class="previw">
                        <!--小图容器-->
                        <div class="zoomImgBox">
                            <!--小图-->
                            <!--<img src="./images/s1.png" alt="">-->
                            <!--蒙版-->
                        </div>
                        <!--大图容器-->

                    </div>
                    <!--缩略图-->
                    <div class="thumbnail">
                        <a href="javascript:;" class="prev">&lt;</a>
                        <!--图片显示区域-->
                        <div class="itemWrap">
                            <ul>
                                <!--<li><img src="images/s1.png" alt=""></li>-->
                                <!--<li><img src="images/s2.png" alt=""></li>-->
                                <!--<li><img src="images/s3.png" alt=""></li>-->
                                <!--<li><img src="images/s1.png" alt=""></li>-->
                                <!--<li><img src="images/s2.png" alt=""></li>-->
                                <!--<li><img src="images/s3.png" alt=""></li>-->
                                <!--<li><img src="images/s1.png" alt=""></li>-->
                                <!--<li><img src="images/s2.png" alt=""></li>-->
                                <!--<li><img src="images/s3.png" alt=""></li>-->
                                <!--<li><img src="images/s1.png" alt=""></li>-->
                                <!--<li><img src="images/s2.png" alt=""></li>-->
                                <!--<li><img src="images/s3.png" alt=""></li>-->
                            </ul>
                        </div>
                        <a href="javascript:;" class="next">&gt;</a>
                    </div>
                </div>
                <!--筛选区域-->
                <div class="chooseWrap">
                    <!--商品简介-->
                    <div class="infoTop">

                    </div>
                    <!--筛选区域-->
                    <div class="choose">
                        <!--选项-->
                        <div class="chooseArea">
                            <!--<dl>-->
                                <!--<dt>选择颜色</dt>-->
                                <!--<dd>金色</dd>-->
                                <!--<dd>银色</dd>-->
                                <!--<dd>黑色</dd>-->
                            <!--</dl>-->
                            <!--<dl>-->
                                <!--<dt>内存容量</dt>-->
                                <!--<dd>16G</dd>-->
                                <!--<dd>64G</dd>-->
                                <!--<dd>128G</dd>-->
                                <!--<dd>256G</dd>-->
                            <!--</dl>-->
                            <!--<dl>-->
                                <!--<dt>选择版本</dt>-->
                                <!--<dd>公开版</dd>-->
                                <!--<dd>移动版</dd>-->
                            <!--</dl>-->
                            <!--<dl>-->
                                <!--<dt>购买方式</dt>-->
                                <!--<dd>官方标配</dd>-->
                                <!--<dd>优惠移动版</dd>-->
                                <!--<dd>电信优惠版</dd>-->
                            <!--</dl>-->
                        </div>
                        <!--购物车-->
                        <div class="carWrap">
                            <div class="control">
                                <input type="text">
                                <a href="javascript:;">+</a>
                                <a href="javascript:;" class="minus">-</a>
                            </div>
                            <button class="addCar">加入购物车</button>
                        </div>
                    </div>
            </div>


            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="js/data.js"></script>
<script type="text/javascript">
    console.log(goodData);
    window.onload = function () {
//      放大镜 大图路径索引
        var previwID = 0;

//        路径导航
        conPoin();
        function conPoin() {
//            需要获取数据
            var path = goodData.path;
//            路径导航的父容器
            var conPoinNode = document.querySelector('.wrap .main .mainCon .conPoin');

            for (var i = 0; i < path.length; i++) {
//              数组的长度是多少  就需要创建多少个a标签 所以直接在循环最开始的时候创建a标签即可
                var aNode = document.createElement('a');

//               判断是否是最后一个路径  如果是不需要设置href属性 不需要创建i标签
                if( i == path.length-1){
//                  只要能够进入这个if当中 说明path[i]  一定对应数组当中最后一个元素的内容
                    aNode.innerHTML = path[i].title;//   在遍历的过程当中  使用path这个数组中每一个对象的title属性的值作为a标签的文本
                    conPoinNode.appendChild(aNode);
                }else{
//                   如果不是最后一个 我们就需要给a标签设置文本 设置href属性  并且同时创建i标签 添加斜线
                    aNode.innerHTML = path[i].title;
                    aNode.href = path[i].url;
                    conPoinNode.appendChild(aNode);
                    var iNode = document.createElement('i');
                    iNode.innerHTML = '/';
                    conPoinNode.appendChild(iNode);
                }
            }
        }
//        放大镜
        previw();
        function previw() {
//          放大镜父容器
            var previwNode = document.querySelector('.wrap .main .mainCon .infoWrap .previwWrap .previw');
//          小图容器
            var zoomImgBox = document.querySelector('.wrap .main .mainCon .infoWrap .previwWrap .previw .zoomImgBox')
//          创建蒙版
            var maskNode = null;
//          创建大图
            var bigImg = null;
//          大图容器
            var bigImgBox = null;
//          小图动态渲染
            var imagessrc = goodData.imagessrc;
            var smallImg = document.createElement('img');
//          小图默认 应该使用缩略图的第一张来当做图片的路径
            smallImg.src = imagessrc[0].s;
            zoomImgBox.appendChild(smallImg);



//           当鼠标移入时  创建蒙版  大图容器 大图     
            previwNode.onmouseenter = function () {
                if(!maskNode){//  当你需要一个为假的值 去执行if的逻辑的时候   直接对这个值取反 写在判断条件里就行了
//                  创建蒙版
                    maskNode = document.createElement('div');
                    maskNode.className = 'mask';
                    zoomImgBox.appendChild(maskNode);
//                  创建大图容器
                    bigImgBox = document.createElement('div');
                    bigImgBox.className = 'bigImgBox';
                    previwNode.appendChild(bigImgBox);
//                  创建大图
                    bigImg = document.createElement('img');
//                    bigImg = new Image();
//                    bigImg.src = './images/b1.png';
                    bigImg.src = imagessrc[previwID].b;
                    bigImgBox.appendChild(bigImg);
                    console.log(previwNode.getBoundingClientRect())
                }
//              当移入放大镜区域时  才需要绑定move事件
                zoomImgBox.onmousemove = function (event) {
//                  高版本浏览器 会将试讲对象作为事件回调函数的第一个形参传递给我们使用
//                  但是低版本浏览器不行    低版本浏览器 是将事件对象作为window的一个属性存在的
                    event = event || window.event;
//                  根据当前鼠标的坐标 来修改蒙版的位置
//                  鼠标的位置是不能通过我们的代码所修改的 所以我们想让蒙版的正中心和鼠标重合得话 我们只能通过修改蒙版位置来实现
//                  向左和向上  修正自身宽度及高度一半的值  即可让蒙版中心和鼠标重合
//                    getBoundingClientRect()  是获取一个元素相对于视口的位置最干净的获取方式
//                  鼠标距离视口左侧的值 - 父容器距离视口左侧的值 - 蒙版元素宽度的一半
                    var maskPosition = {
                        left: event.clientX - previwNode.getBoundingClientRect().left - maskNode.offsetWidth / 2,
                        top: event.clientY - previwNode.getBoundingClientRect().top - maskNode.offsetHeight / 2
                    }
//                  蒙版的边界值判断
//                  大于最大值等于最大值 小于最小值等于最小值   范围限定类
//                  大于最大值等于最小值 小于最小值等于最大值   首尾相接类
                    if(maskPosition.left < 0 ){
                      maskPosition.left = 0;
                    }else if(maskPosition.left > previwNode.clientWidth - maskNode.offsetWidth){
                      maskPosition.left = previwNode.clientWidth - maskNode.offsetWidth;
                    }
                    if(maskPosition.top < 0){
                      maskPosition.top = 0;
                    }else if(maskPosition.top > previwNode.clientHeight - maskNode.offsetHeight){
                      maskPosition.top = previwNode.clientHeight - maskNode.offsetHeight;
                    }


//                   修改蒙版位置
                    maskNode.style.left = maskPosition.left + 'px';
                    maskNode.style.top = maskPosition.top + 'px';
//                  根据蒙版的位置    来计算大图的位置
//                  计算比例      蒙版可移动空间 / 大图可移动空间
                    var scale = (previwNode.clientWidth - maskNode.offsetWidth) / (bigImg.offsetWidth - bigImgBox.clientWidth)

//                  根据当前 蒙版的位置和计算的比例 得到大图的位置
                    var bigImgPosition = {
                        left:maskPosition.left / scale,
                        top:maskPosition.top / scale
                    }
//                         20                10   / 0.5
                    bigImg.style.marginLeft = -bigImgPosition.left + 'px';
                    bigImg.style.marginTop = -bigImgPosition.top + 'px';

                }
//              当鼠标离开放大镜区域时   移除move事件和leave事件  并且删除蒙版 大图容器 大图
                previwNode.onmouseleave = function () {
                    zoomImgBox.removeChild(maskNode);
                    previwNode.removeChild(bigImgBox);
//                  删除元素后 需要重置元素变量为空的状态
                    maskNode = null;
                    bigImgBox = null;
                    bigImg = null;
//                  dom0级事件
//                  通过addEventlistener  叫做dom2级事件
                    zoomImgBox.onmousemove = null;
                    previwNode.onmouseleave = null;

                }



            }


        }
//        缩略图
        thumbnail();
        function thumbnail() {
//          左右按钮
            var prevNode = document.querySelector('.wrap .main .mainCon .infoWrap .previwWrap .thumbnail a.prev');
            var nextNode = document.querySelector('.wrap .main .mainCon .infoWrap .previwWrap .thumbnail a.next');
//          图片容器     为了控制这个ul的left值
            var list = document.querySelector('.wrap .main .mainCon .infoWrap .previwWrap .thumbnail .itemWrap ul');
//          缩略图动态渲染
//          获取图片数据
            var imagessrc = goodData.imagessrc;

            imagessrc.forEach(function (item) {
//              当前这个数组有多少个元素（长度）   我们就要创建多少个li  并且在每一个li当中添加一张图片
//                  图片的链接 就是 当前数组当中每一个对象的s属性的值(item.s)
                var liNode = document.createElement('li');
                var imgNode = document.createElement('img');
                imgNode.src = item.s;
                liNode.appendChild(imgNode);
                list.appendChild(liNode);
            });


//          获取li集合
            var items = document.querySelectorAll('.wrap .main .mainCon .infoWrap .previwWrap .thumbnail .itemWrap ul li');
            console.log(items.length)
//          移动图片张数
            var moveNum = 2;
//          定义默认显示张数
            var showImg = 5;
//          每次移动两张小图     计算单次的偏移量
//          显示图片的张数 * （ 图片的宽度 + 一个图片的marginRight）
            var moveLeft = (items[0].offsetWidth + 20) * moveNum;
            console.log(moveLeft);
//          计算一共可以移动的距离  （总张数 - 显示张数） * （图片宽 + marginRight）
            var countLeft = (items.length - showImg) * (items[0].offsetWidth + 20);
//          需要定义一个变量  记录已经移动的距离
            var tempLeft = 0;
//          给next按钮 绑定单击事件
            nextNode.onclick = function () {
//              如果已经走过的距离 小于总共可以走的距离 才能移动
                if(tempLeft < countLeft){
//                  总距离 - 已经移动的距离 = 剩余距离
//                  每一次的移动 都是用剩余距离和单次偏移左比较  如果剩余距离大于单次偏移 则正常移动 如果不大于 剩多少走多少
                    if(countLeft - tempLeft > moveLeft){
                       tempLeft += moveLeft;
                    }else{
//                        如果能够进入到这个else当中 说明当前的剩余空间 不够走一个moveLeft 直接走剩余部分
                        tempLeft = countLeft;
                    }
//                  需要给list设置left的值为负值  才能够让容器向左移动 看到右侧的图片
                    list.style.left = -tempLeft + 'px';
                }
            }
//          给prev按钮绑定单击事件
            prevNode.onclick = function () {
//              点击右侧按钮记录的已经移动的距离 对于prev按钮来说 就是可移动的空间
                if(tempLeft > 0){
//                   能够进入这个if当中 则说明当前左侧还有剩余的空间 可以移动
                    if(tempLeft > moveLeft){
                      tempLeft -= moveLeft;
                    }else{
                        tempLeft = 0;
                    }
//                    list的left值  永远都为赋值 最大为0  如果出现正值  那么ul左侧一定出现留白了 所以不可能
                    list.style.left = -tempLeft + 'px';
                }
            }


        }
//        缩略图点击功能
        thumbnailClick();
        function thumbnailClick() {
//          获取缩略图中li 的集合
            var items = document.querySelectorAll('.wrap .main .mainCon .infoWrap .previwWrap .thumbnail .itemWrap ul li');
            var imagessrc = goodData.imagessrc;
//          获取小图
            var smallImg = document.querySelector('.wrap .main .mainCon .infoWrap .previwWrap .previw .zoomImgBox img');
            for (var i = 0; i < items.length; i++) {
                items[i].index = i;
//              增加索引  是为了在点击事件中 判断当前点击的li的索引
//              然后去数组中找到这个索引对应的那个对象  然后把这个对象的s属性对应的链接 设置给小图
                items[i].onclick = function () {
                    var imgSrc = imagessrc[this.index].s;
                    smallImg.src = imgSrc;
//                  在当前这个位置  我们不能直接操作大图  原因是当你能够点击缩略图时  大图元素一定是不存在的
                    console.log(this.index);
                    previwID = this.index;


                }

            }


        }
//      商品信息数据渲染
        infoData();
        function infoData() {
            var infoTopNode = document.querySelector('.wrap .main .mainCon .infoWrap .chooseWrap .infoTop');
            var goodsDetail = goodData.goodsDetail;
            var str = `
                <h3>${goodsDetail.title}</h3>
                <p>${goodsDetail.recommend}</p>
                <div class="priceWrap">
                <div class="priceTop">
                <p class="title">价&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;格</p>
                <p class="price">
                <i>¥</i>
                <em>${goodsDetail.price}</em>
                <span>降价通知</span>
                </p>
                <p class="remark">
                <i>累计评价</i>
                <span>${goodsDetail.evaluateNum}</span>
                </p>
                </div>
                <div class="priceBottom">
                <p class="title">促&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;销</p>
                <div>
                <i>${goodsDetail.promoteSales.type}</i>
                <span>${goodsDetail.promoteSales.content}</span>
                </div>
                </div>
                </div>
                <div class="support">
                <div>
                <p class="title">支&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;持</p>
                <p class="text">${goodsDetail.support}</p>
                </div>
                <div>
                <p class="title">配&nbsp;送&nbsp;至</p>
                <p class="text">${goodsDetail.address}</p>
                </div>
                </div>`;
            infoTopNode.innerHTML = str;
          
        }
//      选择其余逻辑
        chooseArea();
        function chooseArea() {
            var crumbData = [
                {
                    title:'选择颜色',
                    data:['金色','银色','黑色','彩色']
                },
                {
                    title:'内存容量',
                    data:['16G','64G','128G','256G']
                },
                {
                    title:'选择版本',
                    data:['公开版','移动版']
                },
                {
                    title:'购买方式',
                    data:['官方标配','优惠移动版','电信优惠版']
                },
            ];
            var chooseArea = document.querySelector('.wrap .main .mainCon .infoWrap .chooseWrap .choose .chooseArea');
//          这个数据当中  有多少个对象 就要创建多少个dl 还有dt  每个对象的title属性 作为dt的文本
//          每个对象中的data属性的长度  决定了在这个dl当中有多少个dd  data数组当中每一个元素的值 就是dd的文本
            crumbData.forEach(function (item) {
//               当前的item是 数组当中每一个对象
//               创建dl
                var dlNode = document.createElement('dl');
//                创建dt
                var dtNode = document.createElement('dt');
//                  将每一个对象中的title属性 作为dt的文本
                dtNode.innerHTML = item.title;
                dlNode.appendChild(dtNode);
//                {
//                    title:'购买方式',
//                        data:['官方标配','优惠移动版','电信优惠版']
//                }
                item.data.forEach(function (item) {
//                    这里的item  对应的是data当中存储的每一个选项的文本
                    var ddNode = document.createElement('dd');
                    ddNode.innerHTML = item;
                    dlNode.appendChild(ddNode);
                });
//                代码执行到这里   完成了一个dl及内部所有内容的拼装
                chooseArea.appendChild(dlNode);
            });
//          为了能够是我们选择的结果有序   所以我们需要在存储结果的时候 就让他们按照选项的顺序进行存储
//          声明一个和选项个数长度相等的数组   然后每一次点击时   获取当前点击的这个dd的父级（dl）的索引
//          然后将选择的结果  存储进数组当中这个索引对应的位置
//           在创建时 我们遍历数组  有内容则创建 没内容直接忽略


        }
      
    }
</script>
</html>